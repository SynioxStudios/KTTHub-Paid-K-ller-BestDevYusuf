-- KTT PAID KILL FARM - Global Searcher & Auto Hunter
-- Yapımcı: ByYusuf

local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")

-- ANA FONKSİYON: Global Oyuncu Arama
local function FindPlayerGlobal(targetName)
    -- 1. ADIM: Oyuncunun UserId'sini al
    local s, targetId = pcall(function()
        return Players:GetUserIdFromNameAsync(targetName)
    end)
    
    if not s or not targetId then return nil end

    -- 2. ADIM: Roblox API'sini kullanarak oyuncunun hangi serverda olduğunu sorgula
    -- Not: Bu özellik sadece hedef oyuncunun "Join" ayarı açıksa sonuç verir.
    local success, result = pcall(function()
        -- Bu kısım exploitlerin sunduğu 'GetPlayerPlaceInstance' benzeri bir mantıkla çalışır
        return game:HttpGet("https://api.roblox.com/users/"..targetId.."/onlinestatus") 
    end)

    return targetId
end

-- JOIN BUTONU GÜNCELLEMESİ
JoinButton.MouseButton1Click:Connect(function()
    local searchInput = PlayerInput.Text
    if searchInput == "" then return end
    
    PlayerInput.Text = "Küresel Tarama Başladı..."
    
    -- Önce mevcut server'ı kontrol et (DisplayName desteği ile)
    for _, p in pairs(Players:GetPlayers()) do
        if string.find(p.Name:lower(), searchInput:lower()) or string.find(p.DisplayName:lower(), searchInput:lower()) then
            PlayerInput.Text = "Hedef Burada! TP..."
            Players.LocalPlayer.Character.HumanoidRootPart.CFrame = p.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,3)
            return
        end
    end

    -- Eğer mevcut serverda yoksa, derin tarama yap
    -- Burası 'Server Hopping' ile birleşir
    PlayerInput.Text = "Hedef bu sunucuda yok!"
    task.wait(1)
    
    -- OTO SERVER HOP (TAG BULANA KADAR)
    _G.HuntingTag = searchInput:lower()
    
    local function AutoHop()
        PlayerInput.Text = "Yeni Sunucu Aranıyor..."
        local url = "https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"
        local servers = HttpService:JSONDecode(game:HttpGet(url))
        
        for _, server in pairs(servers.data) do
            if server.playing < server.maxPlayers and server.id ~= game.JobId then
                TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id, Players.LocalPlayer)
                break
            end
        end
    end
    
    AutoHop()
end)

-- OTOMATİK TAKİP (Sunucuya girer girmez çalışır)
-- Bu kodu scriptin en başına koyarsan her yeni serverda otomatik kontrol yapar
spawn(function()
    while task.wait(2) do
        if _G.HuntingTag then
            for _, p in pairs(Players:GetPlayers()) do
                if string.find(p.Name:lower(), _G.HuntingTag) or string.find(p.DisplayName:lower(), _G.HuntingTag) then
                    print("HEDEF BULUNDU: " .. p.Name)
                    -- Buraya istersen otomatik bildirim veya ses ekleyebiliriz
                end
            end
        end
    end
end)
